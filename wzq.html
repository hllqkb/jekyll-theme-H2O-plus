<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>äº”å­æ£‹--byæ°´(âŠ™oâŠ™)å•Š</title>
 
    <style>
        #canvas{
            display: block;
            margin:50px auto;
            box-shadow: -2px -2px 2px #EFEFEF, 5px 5px 5px #b9b9b9;
        }
    </style>
</head>
<body>
 
    <canvas id="canvas"></canvas>
    <script>
    c=document.getElementById("canvas")
    p=c.getContext("2d")
    //åŸºæœ¬è®¾ç½®
    me=true//true=black false=white
    fs=[]//åˆ†æ•°
    bs=0//æ­¥æ•°
    boxs=[]//è½å­ç‚¹
    wins=[]//èµ¢æ³•
    ms=[]//æˆ‘çš„åˆ†æ•°
    cs=[]//ç”µè„‘çš„åˆ†æ•°
    wh=450//ç”»å¸ƒé•¿å®½
    fs=[]//éšæœºåˆ†æ•°
    long=15//å®½åº¦
    long1=long*2//å®½åº¦1
    qz=13//æ£‹å­å¤§å°
    over=false//æ˜¯å¦ç»“æŸæ¸¸æˆ
    count=0//èµ¢æ³•æ•°é‡
    //æ‰€æœ‰è½å­ç‚¹(äºŒç»´æ•°ç»„) 1=black 2=white
    for (var i=0;i<long;i++){
        boxs[i]=[]
    for (var j=0;j<long;j++){
    boxs[i][j]=0
}
}
//éšæœºåˆ†æ•°ï¼Œè‡ªå·±æ”¹å§
function randfs(){
for (var i=1;i<5;i++){
    switch (i){
    case 1:
   fs1=random(50,50)
    fs[i]=fs1
    break;
    case 2:
    fs1=random(100,100)
    fs[i]=fs1
    break;
    case 3:
    fs1=random(450,450)
    fs[i]=fs1
    break;
    case 4:
    fs1=random(10000,10000)
    fs[i]=fs1
    break;
}
}
}
randfs()
    //èµ¢æ³•ç»Ÿè®¡æ•°ç»„
    myWin = [];
    computerWin = [];
    //make wins's 3ç»´æ•°ç»„
    for (var i=0;i<long;i++){
        wins[i]=[]
    for (var j=0;j<long;j++){
    wins[i][j]=[]
}
}
    //è·å–572ç§èµ¢æ³•
    for(var i=0;i<long;i++){
	for(var j=0;j<long-4;j++){
		//æ‰§è¡Œ1æ¬¡
		// wins[0][0][0]=true;
		// wins[0][1][0]=true;
		// wins[0][2][0]=true;
		// wins[0][3][0]=true;
		// wins[0][4][0]=true;
		//æ‰§è¡Œ2æ¬¡
		// wins[0][1][1]=true;
		// wins[0][2][1]=true;
		// wins[0][3][1]=true;
		// wins[0][4][1]=true;
		// wins[0][5][1]=true;
		for(var k=0;k<5;k++){
			wins[i][j+k][count] = true;
		}
		count++;
	}
}
//æ‰€æœ‰ç«–çº¿
for(var i=0;i<long;i++){
	for(var j=0;j<long-4;j++){
		for(var k=0; k<5;k++){
			wins[j+k][i][count] = true;
		}
		count++;
	}
}
//æ‰€æœ‰æ–œçº¿'/'
for(var i=0;i<long-4;i++){
	for(var j=0;j<long-4;j++){
		for(var k=0; k<5;k++){
			wins[i+k][j+k][count] = true;
		}
		count++;
	}
}
//æ‰€æœ‰åæ–œçº¿'\'
for(var i=0;i<long-4;i++){
	for(var j=long-1;j>3;j--){
		for(var k=0; k<5;k++){
			wins[i+k][j-k][count] = true;
		}
		count++;
	}
}
//æ•Œæˆ‘åŒæ–¹çš„åœ¨èµ¢æ³•ä¸­çš„æ£‹å­æ•°é‡
for (var i=0;i<count;i++) {
	myWin[i] = 0;
	computerWin[i] = 0;
}
//ç”»å¸ƒé•¿å®½è®¾ç½®
c.width=wh
c.height=wh
//ç”»å¸ƒç»˜ç”»
 var img=new Image()
 img.src="ims.jpg"
 img.onload=function (){
 p.drawImage(img,0,0,450,450)
 }
 //èµ°ä¸€æ­¥
 function gostep(x,y,me){
     //è¿˜æ˜¯ä½¿æ£‹å­è½åœ¨åæ ‡ç³»ä¸Š
     var x=x*long1+long
     var y=y*long1+long
     //ç”»å­
     var gradient = p.createRadialGradient(x,y,qz,x,y,0);
     p.beginPath()
     p.arc(x,y,qz,0,360)
     p.closePath()
    if (me){
        //é»‘æ–¹
        gradient.addColorStop(0,"#0A0A0A");
		gradient.addColorStop(1,"#636766");
           }
else{
    //ç™½æ–¹
    gradient.addColorStop(0,"#D1D1D1");	
    	gradient.addColorStop(1,"#F9F9F9");
}
    p.fillStyle = gradient;
	p.fill();
}
//ç”»å¸ƒå•å‡»äº‹ä»¶
c.onclick=function (e){
    //æ£€æµ‹æ¸¸æˆæ˜¯å¦ç»“æŸ
    if (over){
    return
}
    //ä½¿æ£‹å­è½åœ¨åæ ‡ç³»ä¸Š
    var x=Math.floor(e.offsetX/long1)
    var y=Math.floor(e.offsetY/long1)
    //æ£€æµ‹æ˜¯å¦è½å­
    if (boxs[x][y]==0){
    gostep(x,y,me)
    boxs[x][y]=1
    //æ­¥æ•°åŠ ä¸€
    bs++
    //æ£€æµ‹ä½ æ˜¯å¦èµ¢
    for (var i=0;i<count;i++){
    if (wins[x][y][i]){
    myWin[i]++
    computerWin[i]=6
    if (myWin[i]==5){
        over=true
    setTimeout(function (){
    alert("ä½ ç»ˆäºèµ¢äº†ï¼Œå‘µå‘µ")
},300);
}
}
}
}
else{
    return
}
if (bs==long*long){
    alert("å’Œæ£‹!nbå•Š")
    over=true
}
if (!over){
   //éšæœºåˆ†æ•°
    randfs()
   //æœ€å¼ºäººæœº
    ai(x,y)
}
    me=!me
}
function ai(x1,y1){
    var max = 0; //ä¿å­˜æœ€é«˜åˆ†æ•°ï¼›
	var x = 0, y =0; //ä¿å­˜åæ ‡
   //åˆ†æ•°é…ç½®
   for(var i=0;i<15;i++){
	 	ms[i] = [];
	 	cs[i] = [];
	 	for(var j=0;j<15;j++){
	 		ms[i][j] = 0;
	 		cs[i][j] = 0;
	 	}
	 }
for (var i=0;i<long;i++){
    for (var j=0;j<long;j++){
        //æ£€æµ‹æ£‹ç›˜å„ä¸ªä½ç½®æ˜¯å¦æœ‰å­
        if (boxs[i][j]==0){
            //éå†èµ¢æ³•,æŸä¸ªä½ç½®æ˜¯å¦ç¬¦åˆèµ¢æ³•çš„ä¸€ç§ï¼Œç¬¦åˆ
            //çš„è¯ï¼Œå°±åŠ åˆ†äºæ­¤ä½ç½®ï¼Œç¬¦åˆæ•°é‡è¶Šå¤šï¼ŒåŠ åˆ†è¶Šå¤š
    for (var k=0;k<count;k++){
    if (wins[i][j][k]){
    if(myWin[k]==1){
	 						ms[i][j]+= fs[1];
	 					}else if(myWin[k]==2){
	 						ms[i][j]+= fs[2];
	 					}else if(myWin[k]==3){
	 						ms[i][j]+= fs[3];
	 					}else if(myWin[k]==4){
	 						ms[i][j]+= fs[4];
	 					}
          if(computerWin[k]==1){
	 						cs[i][j]+= fs[1]+25;
	 					}else if(computerWin[k]==2){
	 						cs[i][j]+= fs[2]+25;
	 					}else if(computerWin[k]==3){
	 						cs[i][j]+= fs[3]+25;
	 					}else if(computerWin[k]==4){
	 						cs[i][j]+=fs[4]*2 ;
	 					}
	 		}
//å–æœ€å¤§åˆ†æ•°çš„ç‚¹
       if(cs[i][j]>=max){
	 				max = cs[i][j];
	 				x = i;
	 				y= j;
	 			} 		
          if(ms[i][j]>=max){
	 				max = ms[i][j];
	 				x = i;
	 				y= j;
	 			}
}
}
}
}
//æ•Œæ–¹ä¸‹æ£‹
    me=!me
    if (boxs[x][y]==0){
        if (bs==1){
            rand()
            function rand(){
    jx=random(-1,1)
    jy=random(-1,1)
    x=x1+jx
    y=y1+jy
    if (jx==0 && jy==0 || x<0||y<0||y==15||x==15){
    rand()
}
    }
}
    gostep(x,y,me)
    boxs[x][y]=2
for (var i=0;i<count;i++){
    if (wins[x][y][i]){
    computerWin[i]++
    myWin[i]=6
    if (computerWin[i]==5){
        over=true
    setTimeout(function (){
    alert("ä½ è¾“äº†ï¼Œåƒåœ¾ï¼Œå‘µå‘µğŸ˜Š")
},300);
}
}
}
}
}
//éšæœºæ•°
function random(a,b){
   var c=Math.floor(Math.random()*(b-a+1)+a);
    return c
}
    </script>
</body>
</html>